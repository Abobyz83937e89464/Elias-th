<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Elians Neon</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --neon-blue: #00d2ff;
            --neon-purple: #9d50bb;
            --dark-bg: #050716;
            --card-bg: rgba(255, 255, 255, 0.07);
        }

        body {
            margin: 0;
            background: radial-gradient(circle at top, #0b0f2a, var(--dark-bg));
            color: white;
            font-family: 'Segoe UI', Roboto, sans-serif;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        .screen {
            display: none;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            height: 100%;
            width: 100%;
            box-sizing: border-box;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .active { display: flex; }

        h1 { font-size: 3rem; margin-bottom: 10px; text-shadow: 0 0 15px var(--neon-blue); letter-spacing: 5px; }

        .btn {
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
            border: none;
            border-radius: 20px;
            padding: 16px;
            color: white;
            font-weight: bold;
            width: 90%;
            max-width: 300px;
            margin: 10px 0;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 210, 255, 0.3);
            transition: 0.3s;
            text-transform: uppercase;
        }

        .btn:active { transform: scale(0.95); filter: brightness(1.2); }

        .mode-card {
            background: var(--card-bg);
            border: 1px solid rgba(0, 210, 255, 0.2);
            border-radius: 25px;
            padding: 20px;
            width: 90%;
            margin: 10px;
            text-align: left;
            backdrop-filter: blur(10px);
        }

        .rule-box {
            font-size: 0.9rem;
            color: #ccc;
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 15px;
            margin: 15px 0;
            border-left: 4px solid var(--neon-purple);
        }

        input {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--neon-blue);
            padding: 15px;
            border-radius: 15px;
            color: white;
            width: 80%;
            margin: 10px 0;
            text-align: center;
            outline: none;
        }

        #live-hint {
            font-size: 1.5rem;
            min-height: 50px;
            color: var(--neon-blue);
            text-shadow: 0 0 10px var(--neon-blue);
            margin: 20px 0;
        }

        .score-badge {
            background: var(--card-bg);
            padding: 5px 15px;
            border-radius: 50px;
            border: 1px solid var(--neon-purple);
            font-size: 0.8rem;
        }
    </style>
</head>
<body>

<div id="menu" class="screen active">
    <h1>ELIANS</h1>
    <p style="color: var(--neon-blue)">Morpheus Edition</p>
    <button class="btn" onclick="showScreen('modes')">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
    <button class="btn" style="opacity: 0.7" onclick="showScreen('online')">–°–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π</button>
</div>

<div id="modes" class="screen">
    <h2>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º</h2>
    <div class="mode-card" onclick="selectMode('online')">
        <h3>üåê –ü–æ —Å–µ—Ç–∏</h3>
        <p>–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π Elians —Å —á–∞—Ç–æ–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.</p>
    </div>
    <div class="mode-card" onclick="selectMode('call')">
        <h3>üìû –†–µ–∂–∏–º —Å–æ–∑–≤–æ–Ω–∞</h3>
        <p>–ò–≥—Ä–∞–π—Ç–µ –≥–æ–ª–æ—Å–æ–º –≤ Discord –∏–ª–∏ Telegram. –ß–∞—Ç —Å–∫—Ä—ã—Ç.</p>
    </div>
    <button class="btn" onclick="showScreen('menu')" style="background: none; border: 1px solid #555;">–ù–∞–∑–∞–¥</button>
</div>

<div id="setup" class="screen">
    <h2 id="setupTitle">–ü—Ä–∞–≤–∏–ª–∞</h2>
    <div id="rulesContent" class="rule-box"></div>
    <input id="joinCode" placeholder="–í–í–ï–î–ò–¢–ï –ö–û–î –ö–û–ú–ù–ê–¢–´">
    <button class="btn" onclick="joinRoom()">–í–æ–π—Ç–∏ –≤ –∫–æ–º–Ω–∞—Ç—É</button>
    <button class="btn" onclick="createRoom()" style="background: rgba(255,255,255,0.1)">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é</button>
</div>

<div id="online" class="screen">
    <h3>–°–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π</h3>
    <p style="font-size: 0.8rem">–ß—Ç–æ–±—ã –ø—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞, –æ–Ω –¥–æ–ª–∂–µ–Ω —Ö–æ—Ç—è –±—ã —Ä–∞–∑ –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞!</p>
    <div id="friendList" style="width: 100%"></div>
    <button class="btn" onclick="showScreen('menu')">–ù–∞–∑–∞–¥</button>
</div>

<div id="game" class="screen">
    <div class="score-badge" id="scoreA">–ö–æ–º–∞–Ω–¥–∞ A: 0</div>
    <div id="wordDisplay" style="font-size: 2rem; margin: 20px 0; font-weight: bold;"></div>
    <div id="live-hint">–û–∂–∏–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞...</div>
    
    <input id="hintInput" placeholder="–û–±—ä—è—Å–Ω—è–π —Å–ª–æ–≤–æ..." oninput="sendHint()" style="display:none;">
    <button id="correctBtn" class="btn" onclick="sendAction('CORRECT')" style="display:none; background: #2ecc71;">–£–ì–ê–î–ê–õ–ò!</button>
    
    <div id="timer" style="margin-top: auto; font-size: 1.2rem;">60s</div>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
    const ws = new WebSocket(`${protocol}//${window.location.host}`);

    let currentMode = 'online';
    const userId = tg.initDataUnsafe?.user?.id || "u" + Math.random().toString(36).substring(7);
    const username = tg.initDataUnsafe?.user?.first_name || "Morpheus_Guest";

    ws.onopen = () => {
        ws.send(JSON.stringify({ type: "REGISTER", userId, username, tgId: tg.initDataUnsafe?.user?.id }));
    };

    ws.onmessage = (e) => {
        const data = JSON.parse(e.data);
        if (data.type === "ROOM_CREATED" || data.type === "PLAYERS_UPDATE") {
            showScreen('game'); // –£–ø—Ä–æ—Å—Ç–∏–º –¥–ª—è —Ç–µ—Å—Ç–∞: —Å—Ä–∞–∑—É –≤ –±–æ–π
        }
        if (data.type === "ROUND_START") {
            document.getElementById('wordDisplay').innerText = data.word ? data.word.toUpperCase() : "–£–ì–ê–î–´–í–ê–ô–¢–ï!";
            document.getElementById('hintInput').style.display = data.word ? 'block' : 'none';
            document.getElementById('correctBtn').style.display = data.word ? 'block' : 'none';
        }
        if (data.type === "HINT_LIVE" && currentMode !== 'call') {
            document.getElementById('live-hint').innerText = data.text;
        }
    };

    function selectMode(mode) {
        currentMode = mode;
        const rules = {
            online: "–û–±—ä—è—Å–Ω—è–π—Ç–µ —Å–ª–æ–≤–∞ —á–µ—Ä–µ–∑ —á–∞—Ç. –í–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞ –≤–∏–¥–∏—Ç –ø–æ–¥—Å–∫–∞–∑–∫–∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ. –°–∫–∏–ø - –º–∏–Ω—É—Å –±–∞–ª–ª.",
            call: "–°–æ–∑–≤–æ–Ω–∏—Ç–µ—Å—å —Å –¥—Ä—É–∑—å—è–º–∏! –í —ç—Ç–æ–º —Ä–µ–∂–∏–º–µ —á–∞—Ç —Å–∫—Ä—ã—Ç, —á—Ç–æ–±—ã –Ω–µ –æ—Ç–≤–ª–µ–∫–∞—Ç—å. –ü—Ä–æ—Å—Ç–æ –∂–º–∏—Ç–µ '–£–≥–∞–¥–∞–ª–∏', –∫–æ–≥–¥–∞ –ø–∞—Ä—Ç–Ω–µ—Ä –Ω–∞–∑–æ–≤–µ—Ç —Å–ª–æ–≤–æ."
        };
        document.getElementById('rulesContent').innerText = rules[mode];
        showScreen('setup');
    }

    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    function createRoom() { ws.send(JSON.stringify({ type: "CREATE_ROOM" })); }
    function joinRoom() { 
        const code = document.getElementById('joinCode').value;
        ws.send(JSON.stringify({ type: "JOIN_ROOM", roomId: code.toUpperCase() })); 
    }
    function sendHint() {
        ws.send(JSON.stringify({ type: "HINT", text: document.getElementById('hintInput').value }));
    }
    function sendAction(type) { ws.send(JSON.stringify({ type: type })); }
</script>
</body>
</html>
